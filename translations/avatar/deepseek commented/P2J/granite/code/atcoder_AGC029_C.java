

import java.util.Scanner;

public class atcoder_AGC029_C{
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        int n = scanner.nextInt();
        int[] a = new int[n];
        for (int i = 0; i < n; i++) {
            a[i] = scanner.nextInt();
        }
        int[] dp = new int[n];
        int[] next = new int[n];
        int[] prev = new int[n];
        int[] count = new int[n];
        int[] tmp = new int[n];
        int[] tmp2 = new int[n];
        int[] tmp3 = new int[n];
        int[] tmp4 = new int[n];
        int[] tmp5 = new int[n];
        int[] tmp6 = new int[n];
        int[] tmp7 = new int[n];
        int[] tmp8 = new int[n];
        int[] tmp9 = new int[n];
        int[] tmp10 = new int[n];
        int[] tmp11 = new int[n];
        int[] tmp12 = new int[n];
        int[] tmp13 = new int[n];
        int[] tmp14 = new int[n];
        int[] tmp15 = new int[n];
        int[] tmp16 = new int[n];
        int[] tmp17 = new int[n];
        int[] tmp18 = new int[n];
        int[] tmp19 = new int[n];
        int[] tmp20 = new int[n];
        int[] tmp21 = new int[n];
        int[] tmp22 = new int[n];
        int[] tmp23 = new int[n];
        int[] tmp24 = new int[n];
        int[] tmp25 = new int[n];
        int[] tmp26 = new int[n];
        int[] tmp27 = new int[n];
        int[] tmp28 = new int[n];
        int[] tmp29 = new int[n];
        int[] tmp30 = new int[n];
        int[] tmp31 = new int[n];
        int[] tmp32 = new int[n];
        int[] tmp33 = new int[n];
        int[] tmp34 = new int[n];
        int[] tmp35 = new int[n];
        int[] tmp36 = new int[n];
        int[] tmp37 = new int[n];
        int[] tmp38 = new int[n];
        int[] tmp39 = new int[n];
        int[] tmp40 = new int[n];
        int[] tmp41 = new int[n];
        int[] tmp42 = new int[n];
        int[] tmp43 = new int[n];
        int[] tmp44 = new int[n];
        int[] tmp45 = new int[n];
        int[] tmp46 = new int[n];
        int[] tmp47 = new int[n];
        int[] tmp48 = new int[n];
        int[] tmp49 = new int[n];
        int[] tmp50 = new int[n];
        int[] tmp51 = new int[n];
        int[] tmp52 = new int[n];
        int[] tmp53 = new int[n];
        int[] tmp54 = new int[n];
        int[] tmp55 = new int[n];
        int[] tmp56 = new int[n];
        int[] tmp57 = new int[n];
        int[] tmp58 = new int[n];
        int[] tmp59 = new int[n];
        int[] tmp60 = new int[n];
        int[] tmp61 = new int[n];
        int[] tmp62 = new int[n];
        int[] tmp63 = new int[n];
        int[] tmp64 = new int[n];
        int[] tmp65 = new int[n];
        int[] tmp66 = new int[n];
        int[] tmp67 = new int[n];
        int[] tmp68 = new int[n];
        int[] tmp69 = new int[n];
        int[] tmp70 = new int[n];
        int[] tmp71 = new int[n];
        int[] tmp72 = new int[n];
        int[] tmp73 = new int[n];
        int[] tmp74 = new int[n];
        int[] tmp75 = new int[n];
        int[] tmp76 = new int[n];
        int[] tmp77 = new int[n];
        int[] tmp78 = new int[n];
        int[] tmp79 = new int[n];
        int[] tmp80 = new int[n];
        int[] tmp81 = new int[n];
        int[] tmp82 = new int[n];
        int[] tmp83 = new int[n];
        int[] tmp84 = new int[n];
        int[] tmp85 = new int[n];
        int[] tmp86 = new int[n];
        int[] tmp87 = new int[n];
        int[] tmp88 = new int[n];
        int[] tmp89 = new int[n];
        int[] tmp90 = new int[n];
        int[] tmp91 = new int[n];
        int[] tmp92 = new int[n];
        int[] tmp93 = new int[n];
        int[] tmp94 = new int[n];
        int[] tmp95 = new int[n];
        int[] tmp96 = new int[n];
        int[] tmp97 = new int[n];
        int[] tmp98 = new int[n];
        int[] tmp99 = new int[n];
        int[] tmp100 = new int[n];
        int[] tmp101 = new int[n];
        int[] tmp102 = new int[n];
        int[] tmp103 = new int[n];
        int[] tmp104 = new int[n];
        int[] tmp105 = new int[n];
        int[] tmp106 = new int[n];
        int[] tmp107 = new int[n];
        int[] tmp108 = new int[n];
        int[] tmp109 = new int[n];
        int[] tmp110 = new int[n];
        int[] tmp111 = new int[n];
        int[] tmp112 = new int[n];
        int[] tmp113 = new int[n];
        int[] tmp114 = new int[n];
        int[] tmp115 = new int[n];
        int[] tmp116 = new int[n];
        int[] tmp117 = new int[n];
        int[] tmp118 = new int[n];
        int[] tmp119 = new int[n];
        int[] tmp120 = new int[n];
        int[] tmp121 = new int[n];
        int[] tmp122 = new int[n];
        int[] tmp123 = new int[n];
        int[] tmp124 = new int[n];
        int[] tmp125 = new int[n];
        int[] tmp126 = new int[n];
        int[] tmp127 = new int[n];
        int[] tmp128 = new int[n];
        int[] tmp129 = new int[n];
        int[] tmp130 = new int[n];
        int[] tmp131 = new int[n];
        int[] tmp132 = new int[n];
        int[] tmp133 = new int[n];
        int[] tmp134 = new int[n];
        int[] tmp135 = new int[n];
        int[] tmp136 = new int[n];
        int[] tmp137 = new int[n];
        int[] tmp138 = new int[n];
        int[] tmp139 = new int[n];
        int[] tmp140 = new int[n];
        int[] tmp141 = new int[n];
        int[] tmp142 = new int[n];
        int[] tmp143 = new int[n];
        int[] tmp144 = new int[n];
        int[] tmp145 = new int[n];
        int[] tmp146 = new int[n];
        int[] tmp147 = new int[n];
        int[] tmp148 = new int[n];
        int[] tmp149 = new int[n];
        int[] tmp150 = new int[n];
        int[] tmp151 = new int[n];
        int[] tmp152 = new int[n];
        int[] tmp153 = new int[n];
        int[] tmp154 = new int[n];
        int[] tmp155 = new int[n];
        int[] tmp156 = new int[n];
        int[] tmp157 = new int[n];
        int[] tmp158 = new int[n];
        int[] tmp159 = new int[n];
        int[] tmp160 = new int[n];
        int[] tmp161 = new int[n];
        int[] tmp162 = new int[n];
        int[] tmp163 = new int[n];
        int[] tmp164 = new int[n];
        int[] tmp165 = new int[n];
        int[] tmp166 = new int[n];
        int[] tmp167 = new int[n];
        int[] tmp168 = new int[n];
        int[] tmp169 = new int[n];
        int[] tmp170 = new int[n];
        int[] tmp171 = new int[n];
        int[] tmp172 = new int[n];
        int[] tmp173 = new int[n];
        int[] tmp174 = new int[n];
        int[] tmp175 = new int[n];
        int[] tmp176 = new int[n];
        int[] tmp177 = new int[n];
        int[] tmp178 = new int[n];
        int[] tmp179 = new int[n];
        int[] tmp180 = new int[n];
        int[] tmp181 = new int[n];
        int[] tmp182 = new int[n];
        int[] tmp183 = new int[n];
        int[] tmp184 = new int[n];
        int[] tmp185 = new int[n];
        int[] tmp186 = new int[n];
        int[] tmp187 = new int[n];
        int[] tmp188 = new int[n];
        int[] tmp189 = new int[n];
        int[] tmp190 = new int[n];
        int[] tmp191 = new int[n];
        int[] tmp192 = new int[n];
        int[] tmp193 = new int[n];
        int[] tmp194 = new int[n];
        int[] tmp195 = new int[n];
        int[] tmp196 = new int[n];
        int[] tmp197 = new int[n];
        int[] tmp198 = new int[n];
        int[] tmp199 = new int[n];
        int[] tmp200 = new int[n];
        int[] tmp201 = new int[n];
        int[] tmp202 = new int[n];
        int[] tmp203 = new int[n];
        int[] tmp204 = new int[n];
        int[] tmp205 = new int[n];
        int[] tmp206 = new int[n];
        int[] tmp207 = new int[n];
        int[] tmp208 = new int[n];
        int[] tmp209 = new int[n];
        int[] tmp210 = new int[n];
        int[] tmp211 = new int[n];
        int[] tmp212 = new int[n];
        int[] tmp213 = new int[n];
        int[] tmp214 = new int[n];
        int[] tmp215 = new int[n];
        int[] tmp216 = new int[n];
        int[] tmp217 = new int[n];
        int[] tmp218 = new int[n];
        int[] tmp219 = new int[n];
        int[] tmp220 = new int[n];
        int[] tmp221 = new int[n];
        int[] tmp222 = new int[n];
        int[] tmp223 = new int[n];
        int[] tmp224 = new int[n];
        int[] tmp225 = new int[n];
        int[] tmp226 = new int[n];
        int[] tmp227 = new int[n];
        int[] tmp228 = new int[n];
        int[] tmp229 = new int[n];
        int[] tmp230 = new int[n];
        int[] tmp231 = new int[n];
        int[] tmp232 = new int[n];
        int[] tmp233 = new int[n];
        int[] tmp234 = new int[n];
        int[] tmp235 = new int[n];
        int[] tmp236 = new int[n];
        int[] tmp237 = new int[n];
        int[] tmp238 = new int[n];
        int[] tmp239 = new int[n];
        int[] tmp240 = new int[n];
        int[] tmp241 = new int[n];
        int[] tmp242 = new int[n];
        int[] tmp243 = new int[n];
        int[] tmp244 = new int[n];
        int[] tmp245 = new int[n];
        int[] tmp246 = new int[n];
        int[] tmp247 = new int[n];
        int[] tmp248 = new int[n];
        int[] tmp249 = new int[n];
        int[] tmp250 = new int[n];
        int[] tmp251 = new int[n];
        int[] tmp252 = new int[n];
        int[] tmp253 = new int[n];
        int[] tmp254 = new int[n];
        int[] tmp255 = new int[n];
        int[] tmp256 = new int[n];
        int[] tmp257 = new int[n];
        int[] tmp258 = new int[n];
        int[] tmp259 = new int[n];
        int[] tmp260 = new int[n];
        int[] tmp261 = new int[n];
        int[] tmp262 = new int[n];
        int[] tmp263 = new int[n];
        int[] tmp264 = new int[n];
        int[] tmp265 = new int[n];
        int[] tmp266 = new int[n];
        int[] tmp267 = new int[n];
        int[] tmp268 = new int[n];
        int[] tmp269 = new int[n];
        int[] tmp270 = new int[n];
        int[] tmp271 = new int[n];
        int[] tmp272 = new int[n];
        int[] tmp273 = new int[n];
        int[] tmp274 = new int[n];
        int[] tmp275 = new int[n];
        int[] tmp276 = new int[n];
        int[] tmp277 = n